<!DOCTYPE html>
<html>

<head>
    <title>Liverpool Cafe</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"
        integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <link rel='stylesheet' href='/stylesheets/views-index.css' />
    <link rel='stylesheet' href='/stylesheets/liverpools-index.css' />
    <link rel='stylesheet' href='/stylesheets/liverpools-show.css' />
    <script defer type="text/javascript" src="/javascripts/editComments.js"></script>

</head>
<%= console.log(liverpool) %>

    <body>
        <%- include('../partials/header') %>
            <div class="main-container border">
                <div class="container">
                    <div class="row">
                        <div class="player-card col-sm border">
                            <div class="player-details container">
                                <div class="container">
                                    <span class="player-name details">
                                        <%=liverpool.playerName%><br>
                                    </span>
                                </div>
                            </div>

                            <div class="player-image">
                                <a href="/liverpools/<%=liverpool._id%>">
                                    <img src="<%=liverpool.img%>" alt="">
                                </a>
                            </div>

                            <div class="player-details container">
                                <div class="container">
                                    <span class="titles">Jersey #: </span>
                                </div>
                                <div class="details-container container">
                                    <span class="details">
                                        <%=liverpool.playerNo%><br>
                                    </span>
                                </div>
                            </div>

                            <div class="player-details container">
                                <div class="container">
                                    <span class="titles">Age: </span>
                                </div>
                                <div class="details-container container">
                                    <span class="details">
                                        <%=liverpool.age%><br>
                                    </span>
                                </div>
                            </div>

                            <div class="player-details container">
                                <div class="container">
                                    <span class="titles">Position: </span>
                                </div>
                                <div class="details-container container">
                                    <span class="details">
                                        <%=liverpool.position%><br>
                                    </span>
                                </div>
                            </div>

                            <div class="player-details container">
                                <div class="title.container container">
                                    <span class="titles">National Team: </span>
                                </div>
                                <div class="details-container container">
                                    <span class="details">
                                        <%=liverpool.nationalTeam%><br>
                                    </span>
                                </div>
                            </div>
                            <% if (user) { %>
                                <div class="player-details container">
                                    <div class="title.container container">
                                        <span class="titles">Favorite: </span>
                                    </div>
                                    <div class="details-container container">
                                        <% if (liverpool.favorite.length>0) { %>
                                            <% liverpool.favorite.forEach(function(f) { %>
                                                <% if (f.user.equals(!user._id)) { %>
                                                    <span class="details">
                                                        <div class="custom-control custom-switch">
                                                            <form id="add-favorite-form"
                                                                action="/liverpools/<%= liverpool._id %>/favorite"
                                                                method="POST">
                                                                <button class="btn btn-sm btn-success" type="submit"
                                                                    name="favorite">Add
                                                                    Favorite</button>
                                                            </form>
                                                        </div>
                                                    </span>
                                                    <%} else { %>
                                                        <span class="details">
                                                            <div class="custom-control custom-switch">
                                                                <form id="delete-favorite-form"
                                                                    action="/liverpools/<%= liverpool._id %>?_method=DELETE"
                                                                    method="POST">
                                                                    <button class="btn btn-sm btn-danger" type="submit"
                                                                        name="favorite">Remove
                                                                        Favorite</button>
                                                                </form>
                                                            </div>
                                                        </span>
                                                        <% } %>


                                                            <% }) %>

                                                                <% } else { %>
                                                                    <span class="details">
                                                                        <div class="custom-control custom-switch">
                                                                            <form id="add-favorite-form"
                                                                                action="/liverpools/<%= liverpool._id %>/favorite"
                                                                                method="POST">
                                                                                <button class="btn btn-sm btn-success"
                                                                                    type="submit" name="favorite">Add
                                                                                    Favorite</button>
                                                                            </form>
                                                                        </div>
                                                                    </span>
                                                                    <% } %>
                                    </div>
                                </div>
                                <% } %>

                        </div>
                    </div>
                </div>

                <div class="container comments border">
                    <div class="create-comment">
                        <% if (user) { %>
                            <form class="comment-form" id="add-content-form" method="POST"
                                action="/liverpools/<%= liverpool._id %>/comments">
                                <textarea placeholder=" your comment.." class="form-control" name="content"></textarea>
                                <input class="btn btn-primary" type="submit" value="Comment">
                            </form>
                    </div>
                    <div class="user-comments">
                        <% if (liverpool.comments.length) { %>

                            <div class="comments-box container overflow-auto">
                                <table class="table table-striped">
                                    <thead>
                                        <tr class="table-primary">
                                            <th></th>
                                            <th>User</th>
                                            <th>Comment</th>
                                            <th>Update</th>
                                        </tr>
                                    </thead>
                                    <tbody class="overflow-auto">
                                        <% liverpool.comments.forEach(function(c) { %>
                                            <tr class="comment-row">
                                                <td class="h-25 avatar">
                                                    <img class="avatar-image" src="<%= c.userAvatar %>" alt="">
                                                </td>
                                                <td class="user">
                                                    <p class="username">
                                                        <%= c.userName.split(" ")[0] %>
                                                    </p>
                                                    <p class=" datetime">
                                                            <%= c.createdAt.toLocaleString() %>
                                                    </p>
                                                </td>
                                                <td class="user-comment">
                                                    <form action="/comments/<%= c._id %>?_method=PUT" method="POST">
                                                        <p id="userComment">
                                                            <%= c.content %>
                                                        </p>
                                                    </form>
                                                </td>

                                                <td class="deleteEdit">
                                                    <% if (user && user._id.equals(c.user)) { %>
                                                        <form id="deleteForm"
                                                            action="/comments/<%= c._id %>?_method=DELETE"
                                                            method="POST">
                                                            <button class="btn btn-sm btn-danger"
                                                                type="submit">X</button>
                                                        </form>
                                                        <button class="btn btn-sm btn-primary edit"
                                                            id="edit">Edit</button>
                                                        <% } %>
                                                </td>



                                            </tr>
                                            <% }); %>
                                    </tbody>
                                </table>
                            </div>
                            <% } %>
                                <!-- // THIS IS WHERE ADDITIONAL NEWLY CREATED COMMENTS WILL GO // -->
                    </div>
                    <% } else { %>
                        <div class="user-comments">
                            <% if (liverpool.comments.length) { %>

                                <div class="comments-box container overflow-auto">
                                    <table class="table table-striped">
                                        <thead>
                                            <tr class="table-primary">
                                                <th></th>
                                                <th>User</th>
                                                <th>Comment</th>
                                                <th></th>
                                            </tr>
                                        </thead>
                                        <tbody class="overflow-auto">
                                            <% liverpool.comments.forEach(function(c) { %>
                                                <tr>
                                                    <td class="avatar">
                                                        <img class="avatar-image" src="<%= c.userAvatar %>" alt="">
                                                    </td>
                                                    <td class="username">
                                                        <%= c.userName %>
                                                    </td>
                                                    <td class="user-comment">
                                                        <%= c.content %>
                                                    </td>

                                                </tr>
                                                <% }); %>
                                        </tbody>
                                    </table>
                                </div>
                                <% } %>
                                    <!-- // THIS IS WHERE ADDITIONAL NEWLY CREATED COMMENTS WILL GO // -->
                        </div>
                        <% } %>
                </div>


    </body>

</html>